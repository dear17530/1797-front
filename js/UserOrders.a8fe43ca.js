(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["UserOrders"],{"1e4a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mt-4 d-flex justify-center",attrs:{id:"userorders"}},[a("div",[a("v-data-table",{attrs:{headers:e.headers,items:e.orders,expanded:e.expanded,"item-key":"_id","show-expand":""},on:{"click:row":e.clicked},scopedSlots:e._u([{key:"expanded-item",fn:function(t){var r=t.item;return[a("td",{staticClass:"py-4",attrs:{colspan:e.headers.length+1}},[a("OrderCard",{attrs:{item:r}})],1)]}},{key:"item.actions",fn:function(t){var r=t.item;return["已出貨"===r.state?a("v-btn",{attrs:{rounded:"",small:"",color:"#d3a19c"},on:{click:function(t){return e.editstate(r)}}},[a("v-icon",{attrs:{left:"",color:"white"}},[e._v("mdi-checkbox-marked-circle-outline")]),a("span",{staticClass:"white--text"},[e._v("收到包裹")])],1):e._e()]}}])})],1)])},n=[],o=a("5530"),s=a("1da1"),i=(a("96cf"),a("d81d"),a("fb6a"),a("99af"),a("333a"),a("5e86")),c={name:"UserOrders",data:function(){return{search:"",orders:[],editedIndex:-1,expanded:["orders"],singleExpand:!1,headers:[{text:"訂單編號",align:"center",value:"_id",sortable:!1},{text:"地址",value:"address"},{text:"聯絡方式",value:"contact_number"},{text:"訂單日期",value:"date"},{text:"總金額",value:"sum"},{text:"點數折價",value:"redeem"},{text:"付款方式",value:"payment_method"},{text:"付款狀態",value:"payment"},{text:"宅配單號",value:"delivery_number"},{text:"訂單狀態",value:"state"},{value:"actions",sortable:!1}]}},components:{OrderCard:i["a"]},methods:{clicked:function(e){this.expanded.push(e)},editstate:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.axios.patch("/orders/"+e._id,{state:"訂單完成"},{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 2:r=0;case 3:if(!(r<e.products.length)){a.next=9;break}return a.next=6,t.axios.patch("/products/"+e.products[r]._id,{order:e._id},{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 6:r++,a.next=3;break;case 9:return a.next=11,t.axios.get("/products/orderQuantity",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 11:return a.next=13,t.axios.get("/orders/getorders",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 13:n=a.sent,s=n.data,t.orders=s.result.map((function(e){return e.date=e.date.slice(0,10),!1===e.payment?e.payment="待付款":e.payment="已付款",e.products=e.products.map((function(e){return e=Object(o["a"])(Object(o["a"])({},e.product),{},{amount:e.amount,option:e.option}),null===e.image||0===e.image.length?(e.image=e.imagefiles.map((function(e){return"".concat("https://one797back.onrender.com/","/files/").concat(e)})),e.imagefiles=[]):(e.image=e.image.concat(e.imagefiles),e.image=e.image.map((function(e){return"".concat("https://one797back.onrender.com/","/files/").concat(e)})),e.imagefiles=[]),e})),e}));case 16:case"end":return a.stop()}}),a)})))()}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("/orders/getorders",{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:a=t.sent,r=a.data,e.orders=r.result.map((function(e){return e.date=e.date.slice(0,10),!1===e.payment?e.payment="待付款":e.payment="已付款",e.products=e.products.map((function(e){return e=Object(o["a"])(Object(o["a"])({},e.product),{},{amount:e.amount,option:e.option}),null===e.image||0===e.image.length?(e.image=e.imagefiles.map((function(e){return"".concat("https://one797back.onrender.com/","/files/").concat(e)})),e.imagefiles=[]):(e.image=e.image.concat(e.imagefiles),e.image=e.image.map((function(e){return"".concat("https://one797back.onrender.com/","/files/").concat(e)})),e.imagefiles=[]),e})),e})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得訂單失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}},d=c,u=a("2877"),l=a("6544"),m=a.n(l),p=a("8336"),f=a("8fea"),h=a("132d"),x=Object(u["a"])(d,r,n,!1,null,null,null);t["default"]=x.exports;m()(x,{VBtn:p["a"],VDataTable:f["a"],VIcon:h["a"]})},"333a":function(e,t,a){}}]);
//# sourceMappingURL=UserOrders.a8fe43ca.js.map