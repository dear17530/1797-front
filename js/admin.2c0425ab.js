(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin"],{1681:function(t,e,a){},"2c64":function(t,e,a){},3530:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex flex-column align-center mt-4",attrs:{id:"admin"}},[a("v-tabs",{staticStyle:{width:"60%"},attrs:{grow:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"#ebedee"}}),a("v-tab",{attrs:{to:"/admin/adminorders"}},[t._v("訂單管理")]),a("v-tab",{attrs:{to:"/admin/adminanalysis"}},[t._v("營運分析")]),a("v-tab",{attrs:{to:"/admin/adminproducts"}},[t._v("商品管理")])],1),a("v-main",{staticClass:"pt-1"},[a("router-view")],1)],1)},o=[],s={name:"admin",data:function(){return{tab:null}}},n=s,i=a("2877"),l=a("6544"),c=a.n(l),u=a("f6c4"),d=a("71a3"),p=a("fe57"),h=a("9a96"),m=Object(i["a"])(n,r,o,!1,null,null,null);e["default"]=m.exports;c()(m,{VMain:u["a"],VTab:d["a"],VTabs:p["a"],VTabsSlider:h["a"]})},"3d86":function(t,e,a){},"3e4e":function(t,e,a){t.exports=a.p+"img/settings.097bb97b.png"},"84ce":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"adminproducts"}},[r("div",{staticClass:"text-right my-3"},[r("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,o=e.attrs;return[r("v-btn",t._g(t._b({attrs:{rounded:"",text:""}},"v-btn",o,!1),a),[r("v-icon",{attrs:{left:"",fab:"",color:"red lighten-1",middle:""}},[t._v("mdi-plus-circle")]),r("span",[t._v("新增商品")])],1)]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",{staticClass:"pa-5",attrs:{title:t.form._id.length>0?"編輯商品":"新增商品",color:"#ebedee"}},[r("v-card-title",[r("span",{staticClass:"text-h5 font-weight-bold"},[t._v(t._s(t.formTitle))])]),r("v-card-text",[r("v-row",[r("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[r("span",[t._v("商品名稱")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[r("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",rules:t.nameRules,required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),r("v-col",{staticClass:"pb-0 pt-0",attrs:{cols:"12"}},[r("span",[t._v("商品價格")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[r("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",rules:t.priceRules,required:""},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),r("v-col",{staticClass:"pb-0 pt-0",attrs:{cols:"12"}},[r("span",[t._v("商品選項")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"11"}},[r("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",rules:t.optionsRules,required:""},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.add()}},model:{value:t.newoption,callback:function(e){t.newoption=e},expression:"newoption"}})],1),r("v-col",{staticClass:"pl-0",attrs:{cols:"1"}},[r("v-icon",{attrs:{color:"success"},on:{click:function(e){return t.add()}}},[t._v("mdi-plus-circle")])],1),r("v-col",{staticClass:"pb-1 pt-0",attrs:{cols:"12"}},[r("v-chip-group",{attrs:{column:""}},t._l(t.form.options,(function(e){return r("v-chip",{key:e},[t._v(t._s(e)),r("v-icon",{attrs:{color:"red"},on:{click:function(a){return t.deloption(e)}}},[t._v("mdi-minus-circle")])],1)})),1)],1),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[r("span",[t._v("商品敘述")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[r("v-textarea",{attrs:{"background-color":"white",solo:"",dense:"",rules:t.descriptionRules},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("span",[t._v("優惠條件")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("span",[t._v("優惠點數")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",rules:t.countRules,required:""},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",rules:t.couponRules,required:""},model:{value:t.form.coupon,callback:function(e){t.$set(t.form,"coupon",e)},expression:"form.coupon"}})],1),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("span",[t._v("商品分類")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("span",[t._v("商品狀態")])]),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"6"}},[r("v-select",{attrs:{"background-color":"white",solo:"",dense:"",items:t.itemsCategory,required:""},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}})],1),r("v-col",{staticClass:"pt-2 pb-0",attrs:{cols:"6"}},[r("v-radio-group",{staticClass:"mt-0",attrs:{row:""},model:{value:t.form.sell,callback:function(e){t.$set(t.form,"sell",e)},expression:"form.sell"}},[r("v-radio",{attrs:{label:"上架",value:!0}}),r("v-radio",{attrs:{label:"下架",value:!1}})],1)],1),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[r("file-pond",{ref:"pond",attrs:{name:"pond","allow-multiple":"true","max-files":"5","accepted-file-types":"image/jpeg, image/png","label-idle":"點擊或拖曳新增圖片",allowReorder:"true",files:t.form.imagefiles},on:{updatefiles:t.handleFilePondUpdateFile}})],1),r("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[r("v-chip-group",t._l(t.form.image,(function(e){return r("v-chip",{key:e,staticClass:"py-10 px-1"},[r("v-img",{attrs:{src:e,width:"86"}},[t.showDelImageIcon?r("v-icon",{staticClass:"mt-3 ml-1",attrs:{color:"red"},on:{click:function(a){return t.delimage(e)}}},[t._v("mdi-minus-circle")]):t._e()],1)],1)})),1),t.showDelImageIcon?t._e():r("small",[t._v("圖片最少需要一張，若要刪除此圖，請先上傳一張圖片送出後並重新操作。")])],1)],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{staticClass:"mr-2 mb-1",attrs:{plain:""},on:{click:t.reset}},[t._v("取消")]),r("v-btn",{staticClass:"mr-2 mb-1 px-8",attrs:{color:"#f7e7ef",disabled:t.submitDisable},on:{click:t.submit}},[t._v("送出")])],1)],1)],1)],1),r("v-data-table",{staticClass:"px-5",attrs:{headers:t.headers,items:t.products,search:t.search},scopedSlots:t._u([{key:"item.editActions",fn:function(e){var o=e.item;return[r("v-img",{staticClass:"pointer",attrs:{src:a("3e4e"),"max-height":"20","max-width":"20"},on:{click:function(e){return t.editItem(o)}}})]}},{key:"item.sendActions",fn:function(e){var o=e.item;return[o.order_quantity>=o.count?r("v-img",{staticClass:"pointer",attrs:{src:a("92c4"),"max-height":"20","max-width":"20"},on:{click:function(e){return t.sendCoupon(o)}}}):t._e()]}},{key:"item.image",fn:function(t){var e=t.item;return[r("v-img",{attrs:{src:e.image[0],height:"100","aspect-ratio":"1.7"}})]}},{key:"item.sell",fn:function(e){var a=e.item;return[!0===a.sell?r("span",[t._v("上架")]):r("span",[t._v("下架")])]}}])})],1)},o=[],s=a("1da1"),n=(a("96cf"),a("d81d"),a("99af"),a("a434"),a("b0c0"),a("a4d3"),a("e01a"),a("3ca3"),a("ddb0"),a("159b"),{name:"Adminproducts",data:function(){return{editedIndex:-1,search:"",headers:[{text:"",align:"center",value:"editActions",sortable:!1},{text:"",value:"sendActions"},{text:"圖片",value:"image"},{text:"品名",value:"name"},{text:"價格",value:"price"},{text:"分類",value:"category"},{text:"優惠條件",value:"count"},{text:"目前集資",value:"order_quantity"},{text:"優惠點數",value:"coupon"},{text:"狀態",value:"sell"},{text:"選項",value:"options"}],products:[],form:{name:"",price:0,category:"生活用品",description:"",image:[],imagefiles:[],sell:!0,count:0,coupon:0,_id:"",options:["無"]},dialog:!1,valid:!0,nameRules:[function(t){return!!t||"請輸入商品名稱"},function(t){return t&&t.length>=1&&t.length<=15||"品名必須由 1 ~ 15 字元組成"}],optionsRules:[function(t){return!!t||"請輸入選項名稱"},function(t){return t&&t.length>=1&&t.length<=15||"選項必須由 1 ~ 15 字元組成"}],priceRules:[function(t){return!!t||"請輸入商品價錢"},function(t){return t&&t>=1||"價格必須大於 1 元"}],descriptionRules:[function(t){return!!t||"請輸入商品敘述"},function(t){return t&&t.length>=1||"敘述字數必須大於 1"}],countRules:[function(t){return!!t||"請輸入優惠條件"},function(t){return t&&t>=1||"優惠條件必須大於 1"}],couponRules:[function(t){return!!t||"請輸入優惠點數"},function(t){return t&&t>=1||"優惠點數必須大於 1"}],itemsCategory:["生活用品","涮嘴零食","寵物用品","美妝保健","3C用品"],itemsSell:["上架中","下架中"],submitDisable:!1,newoption:"",showImage:[],showDelImageIcon:!0}},computed:{formTitle:function(){return-1===this.editedIndex?"新增商品":"編輯商品"}},methods:{sendCoupon:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.axios.patch("/users/sendCoupon",{id:t._id},{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:return e.$swal({icon:"success",title:"成功",text:"點數發放成功，商品已下架"}),a.next=6,e.axios.get("/products/all",{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 6:r=a.sent,o=r.data,e.products=o.result.map((function(t){return t.image=t.image.concat(t.imagefiles),t.image=t.image.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[],t})),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"});case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()},handleFilePondUpdateFile:function(t){this.form.imagefiles=t.map((function(t){return t.file}))},add:function(){0===this.newoption.length&&this.newoption.length<=15?this.$swal({icon:"errow",title:"錯誤",text:"選項必須由 1 ~ 15 字元組成"}):(this.form.options.push(this.newoption),this.newoption="")},delimage:function(t){var e=this.products[this.editedIndex].image.indexOf(t);this.products[this.editedIndex].image.splice(e,1)},deloption:function(t){var e=this.form.options.indexOf(t);this.form.options.splice(e,1)},editItem:function(t){this.editedIndex=this.products.indexOf(t),this.dialog=!0,this.form={name:this.products[this.editedIndex].name,price:this.products[this.editedIndex].price,category:this.products[this.editedIndex].category,description:this.products[this.editedIndex].description,sell:this.products[this.editedIndex].sell,count:this.products[this.editedIndex].count,coupon:this.products[this.editedIndex].coupon,_id:this.products[this.editedIndex]._id,options:this.products[this.editedIndex].options,image:this.products[this.editedIndex].image,imagefiles:[]}},reset:function(){this.dialog=!1,this.form={name:"",price:0,category:"生活用品",description:"",image:[],sell:!0,count:0,coupon:0,_id:"",options:["無"],imagefiles:[]},this.editedIndex=-1},submit:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.submitDisable=!1,e.prev=1,e.delegateYield(regeneratorRuntime.mark((function e(){var a,r,o,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r in a=new FormData,t.form)if(Array.isArray(t.form[r])&&"imagefiles"===r)for(o in t.form[r])a.append("imagefiles",t.form[r][o]);else Array.isArray(t.form[r])&&"image"===r?null===t.form.image?a.append("image",[]):t.form.image.forEach((function(t){a.append("image",t.substr(-17,17))})):Array.isArray(t.form[r])&&"options"===r?t.form.options.length<=0?a.append("options","無"):t.form.options.forEach((function(t){return a.append("options",t)})):a.append(r,t.form[r]);if(0!==t.form._id.length){e.next=8;break}return e.next=5,t.axios.post("/products",a,{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 5:t.$swal({icon:"success",title:"成功",text:"上傳成功"}),e.next=10;break;case 8:return e.next=10,t.axios.patch("/products/"+t.form._id,a,{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 10:return e.next=12,t.axios.get("/products/all",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 12:s=e.sent,n=s.data,t.products=n.result.map((function(t){return null===t.image?(t.image=t.imagefiles.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]):(t.image=t.image.concat(t.imagefiles),t.image=t.image.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]),t})),t.reset(),t.editedIndex=-1;case 17:case"end":return e.stop()}}),e)}))(),"t0",3);case 3:e.next=8;break;case 5:e.prev=5,e.t1=e["catch"](1),t.$swal({icon:"errow",title:"錯誤",text:e.t1.response.data.message});case 8:case"end":return e.stop()}}),e,null,[[1,5]])})))()}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.get("/products/all",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 3:a=e.sent,r=a.data,t.products=r.result.map((function(t){return null===t.image?(t.image=t.imagefiles.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]):(t.image=t.image.concat(t.imagefiles),t.image=t.image.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]),t})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},watch:{form:{handler:function(){this.editedIndex>-1&&this.form.image.length<=1?this.showDelImageIcon=!1:this.showDelImageIcon=!0},deep:!0}}}),i=n,l=a("2877"),c=a("6544"),u=a.n(c),d=a("8336"),p=a("b0af"),h=a("99d9"),m=a("cc20"),f=a("5530"),g=(a("8f5a"),a("7efd")),v=a("a9ad"),b=a("58df"),x=Object(b["a"])(g["a"],v["a"]).extend({name:"v-chip-group",provide:function(){return{chipGroup:this}},props:{column:Boolean},computed:{classes:function(){return Object(f["a"])(Object(f["a"])({},g["a"].options.computed.classes.call(this)),{},{"v-chip-group":!0,"v-chip-group--column":this.column})}},watch:{column:function(t){t&&(this.scrollOffset=0),this.$nextTick(this.onResize)}},methods:{genData:function(){return this.setTextColor(this.color,Object(f["a"])({},g["a"].options.methods.genData.call(this)))}}}),w=a("62ad"),y=a("8fea"),k=a("169a"),C=a("132d"),S=a("adda"),_=a("15fd"),I=(a("2c64"),a("ba87")),V=a("9d26"),A=a("c37a"),O=a("7e2b"),$=a("4e82"),j=a("5607"),R=a("2b0e"),B=R["default"].extend({name:"rippleable",directives:{ripple:j["a"]},props:{ripple:{type:[Boolean,Object],default:!0}},methods:{genRipple:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.ripple?(t.staticClass="v-input--selection-controls__ripple",t.directives=t.directives||[],t.directives.push({name:"ripple",value:{center:!0}}),this.$createElement("div",t)):null}}}),T=a("7560"),z=(a("d3b7"),a("25f0"),a("4de4"),a("8547"));function D(t){t.preventDefault()}var G=Object(b["a"])(A["a"],B,z["a"]).extend({name:"selectable",model:{prop:"inputValue",event:"change"},props:{id:String,inputValue:null,falseValue:null,trueValue:null,multiple:{type:Boolean,default:null},label:String},data:function(){return{hasColor:this.inputValue,lazyValue:this.inputValue}},computed:{computedColor:function(){if(this.isActive)return this.color?this.color:this.isDark&&!this.appIsDark?"white":"primary"},isMultiple:function(){return!0===this.multiple||null===this.multiple&&Array.isArray(this.internalValue)},isActive:function(){var t=this,e=this.value,a=this.internalValue;return this.isMultiple?!!Array.isArray(a)&&a.some((function(a){return t.valueComparator(a,e)})):void 0===this.trueValue||void 0===this.falseValue?e?this.valueComparator(e,a):Boolean(a):this.valueComparator(a,this.trueValue)},isDirty:function(){return this.isActive},rippleState:function(){return this.isDisabled||this.validationState?this.validationState:void 0}},watch:{inputValue:function(t){this.lazyValue=t,this.hasColor=t}},methods:{genLabel:function(){var t=A["a"].options.methods.genLabel.call(this);return t?(t.data.on={click:D},t):t},genInput:function(t,e){return this.$createElement("input",{attrs:Object.assign({"aria-checked":this.isActive.toString(),disabled:this.isDisabled,id:this.computedId,role:t,type:t},e),domProps:{value:this.value,checked:this.isActive},on:{blur:this.onBlur,change:this.onChange,focus:this.onFocus,keydown:this.onKeydown,click:D},ref:"input"})},onBlur:function(){this.isFocused=!1},onClick:function(t){this.onChange(),this.$emit("click",t)},onChange:function(){var t=this;if(this.isInteractive){var e=this.value,a=this.internalValue;if(this.isMultiple){Array.isArray(a)||(a=[]);var r=a.length;a=a.filter((function(a){return!t.valueComparator(a,e)})),a.length===r&&a.push(e)}else a=void 0!==this.trueValue&&void 0!==this.falseValue?this.valueComparator(a,this.trueValue)?this.falseValue:this.trueValue:e?this.valueComparator(a,e)?null:e:!a;this.validate(!0,a),this.internalValue=a,this.hasColor=a}},onFocus:function(){this.isFocused=!0},onKeydown:function(t){}}}),F=a("80d2"),M=a("d9f7"),E=["title"],q=Object(b["a"])(O["a"],v["a"],B,Object($["a"])("radioGroup"),T["a"]),H=q.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:function(){return{isFocused:!1}},computed:{classes:function(){return Object(f["a"])(Object(f["a"])({"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused},this.themeClasses),this.groupClasses)},computedColor:function(){return G.options.computed.computedColor.call(this)},computedIcon:function(){return this.isActive?this.onIcon:this.offIcon},computedId:function(){return A["a"].options.computed.computedId.call(this)},hasLabel:A["a"].options.computed.hasLabel,hasState:function(){return(this.radioGroup||{}).hasState},isDisabled:function(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly:function(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName:function(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||"radio-".concat(this.radioGroup._uid)},rippleState:function(){return G.options.computed.rippleState.call(this)},validationState:function(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput:function(t){return G.options.methods.genInput.call(this,"radio",t)},genLabel:function(){return this.hasLabel?this.$createElement(I["a"],{on:{click:D},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},Object(F["s"])(this,"label")||this.label):null},genRadio:function(){var t=this.attrs$,e=(t.title,Object(_["a"])(t,E));return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(V["a"],this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput(Object(f["a"])({name:this.computedName,value:this.value},e)),this.genRipple(this.setTextColor(this.rippleState))])},onFocus:function(t){this.isFocused=!0,this.$emit("focus",t)},onBlur:function(t){this.isFocused=!1,this.$emit("blur",t)},onChange:function(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:function(){}},render:function(t){var e={staticClass:"v-radio",class:this.classes,on:Object(M["c"])({click:this.onChange},this.listeners$),attrs:{title:this.attrs$.title}};return t("div",e,[this.genRadio(),this.genLabel()])}}),L=(a("a9e3"),a("ec29"),a("3d86"),a("604c")),N=Object(b["a"])(z["a"],L["a"],A["a"]),P=N.extend({name:"v-radio-group",provide:function(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes:function(){return Object(f["a"])(Object(f["a"])({},A["a"].options.computed.classes.call(this)),{},{"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row})}},methods:{genDefaultSlot:function(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},A["a"].options.methods.genDefaultSlot.call(this))},genInputSlot:function(){var t=A["a"].options.methods.genInputSlot.call(this);return delete t.data.on.click,t},genLabel:function(){var t=A["a"].options.methods.genLabel.call(this);return t?(t.data.attrs.id=this.computedId,delete t.data.attrs.for,t.tag="legend",t):null},onClick:L["a"].options.methods.onClick}}),K=a("0fd9"),Q=a("b974"),J=a("2fa4"),U=a("8654"),Y=a("a844"),W=Object(l["a"])(i,r,o,!1,null,null,null);e["default"]=W.exports;u()(W,{VBtn:d["a"],VCard:p["a"],VCardActions:h["a"],VCardText:h["b"],VCardTitle:h["c"],VChip:m["a"],VChipGroup:x,VCol:w["a"],VDataTable:y["a"],VDialog:k["a"],VIcon:C["a"],VImg:S["a"],VRadio:H,VRadioGroup:P,VRow:K["a"],VSelect:Q["a"],VSpacer:J["a"],VTextField:U["a"],VTextarea:Y["a"]})},"8a35":function(t,e,a){},"8f5a":function(t,e,a){},"92c4":function(t,e,a){t.exports=a.p+"img/giftbox.afb22ddf.png"},a844:function(t,e,a){"use strict";var r=a("5530"),o=(a("a9e3"),a("1681"),a("8654")),s=a("58df"),n=Object(s["a"])(o["a"]);e["a"]=n.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return Object(r["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},o["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var t=this.$refs.input;if(t){t.style.height="0";var e=t.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(a,e)+"px"}},genInput:function(){var t=o["a"].options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput:function(t){o["a"].options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}})},ac89:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"adminanalysis"}},[a("v-row",{staticClass:"mt-0"},[a("v-col",{attrs:{cols:"5"}},[a("span",{staticClass:"text-h5 font-weight-bold"},[t._v("目標業績")])]),a("v-spacer"),a("v-col",{attrs:{cols:"2"}},[a("v-select",{attrs:{items:t.yearItems,label:"年份",solo:"",dense:"","hide-details":"false"},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-select",{attrs:{items:t.monthItems,label:"年份",solo:"",dense:"","hide-details":"false"},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"3"}},[a("p",[t._v("總銷售額")]),a("p",{staticClass:"text-h3"},[t._v(t._s(t.getRevenue))])]),a("v-col",{attrs:{cols:"3"}},[a("p",[t._v("總訂單量")]),a("p",{staticClass:"text-h3"},[t._v(t._s(t.orders.length))])]),t.getRevenue?a("v-col",{attrs:{cols:"3"}},[a("p",[t._v("客單價")]),a("p",{staticClass:"text-h3"},[t._v(t._s(Math.round(t.getRevenue/t.orders.length)))])]):a("v-col",{attrs:{cols:"2"}},[a("p",[t._v("客單價")]),a("p",{staticClass:"text-h3"},[t._v("0")])])],1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("span",{staticClass:"text-h5 font-weight-bold"},[t._v("目標業績")])])],1),a("v-row",{staticClass:"justify-space-between ma-0"},t._l(t.categorySalesChart,(function(e,r){return a("v-col",{key:e.category.chartOptions.labels[0],staticClass:"d-flex flex-column align-center",attrs:{cols:"2"}},[a("apexchart",{attrs:{type:"radialBar",height:"180",options:e.category.chartOptions,series:e.category.series}}),a("p",{staticClass:"mb-0 text-center text-h4"},[t._v(t._s(e.category.totalSaleAmount))]),a("p",{staticClass:"mb-0 text-center"},[t._v("目標業績"),a("v-icon",{staticClass:"mb-1 ml-2",attrs:{small:""},on:{click:function(e){return t.editTargetSales(r)}}},[t._v("mdi-pencil-circle-outline")])],1),a("p",{staticClass:"mb-0 text-center"},[t._v(t._s(t.targetSales[r]))])],1)})),1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("span",{staticClass:"text-h5 font-weight-bold"},[t._v("商品業績")])])],1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-data-table",{staticClass:"ma-0",attrs:{headers:t.headers,items:t.products}}),a("v-dialog",{attrs:{color:"white",persistent:"","max-width":"200px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card-text",[a("v-text-field",{model:{value:t.setTargetSales,callback:function(e){t.setTargetSales=e},expression:"setTargetSales"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.editTargetCancel}},[t._v("取消")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.editTargetubmit}},[t._v("送出")])],1)],1)],1)],1)],1)},o=[],s=a("5530"),n=a("1da1"),i=(a("d81d"),a("4de4"),a("99af"),a("96cf"),{name:"adminanalysis",data:function(){return{dialog:!1,categorySalesChart:[{category:{series:[0],totalSaleAmount:0,chartOptions:{chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"70%"}}},labels:["生活用品"]}}},{category:{series:[0],totalSaleAmount:0,chartOptions:{chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"70%"}}},labels:["涮嘴零食"]}}},{category:{series:[0],totalSaleAmount:0,chartOptions:{chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"70%"}}},labels:["寵物用品"]}}},{category:{series:[0],totalSaleAmount:0,chartOptions:{chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"70%"}}},labels:["美妝保健"]}}},{category:{series:[0],totalSaleAmount:0,chartOptions:{chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"70%"}}},labels:["3C用品"]}}}],orders:[],pie:[{all:{series:[0,3,97,0,0]}}],categorySales:[],targetSales:[],setTargetSales:0,setTargetIndex:0,year:2021,month:8,yearItems:[2021],monthItems:[1,2,3,4,5,6,7,8,9,10,11,12],products:[],headers:[{text:"品名",value:"name"},{text:"價格",value:"price"},{text:"分類",value:"category"},{text:"銷售件數",value:"productQuantity"},{text:"銷售金額",value:"productSaleAmount"},{text:"優惠條件",value:"count"},{text:"優惠點數",value:"coupon"}]}},computed:{getRevenue:function(){if(0===this.categorySales.length)return 0;for(var t=0,e=0;e<this.categorySales.length;e++)t+=this.categorySales[e].totalSaleAmount;return t}},methods:{editTargetSales:function(t){this.dialog=!0,this.setTargetIndex=t},editTargetubmit:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.targetSales[t.setTargetIndex]=t.setTargetSales,t.dialog=!1,e.next=4,t.axios.patch("/admins",{targetSales:t.targetSales},{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 4:t.count();case 5:case"end":return e.stop()}}),e)})))()},editTargetCancel:function(){this.dialog=!1},count:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r,o,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=0;a<t.categorySalesChart.length;a++)t.categorySalesChart[a].category.series=[0],t.categorySalesChart[a].category.totalSaleAmount=0,t.pie[0].all.series=[0,0,0,0,0];return t.categorySales.map((function(e){return"生活用品"===e._id?(t.categorySalesChart[0].category.series=[Math.round(e.totalSaleAmount/t.targetSales[0]*100)],t.categorySalesChart[0].category.totalSaleAmount=e.totalSaleAmount,t.pie[0].all.series[0]=Math.round(e.totalSaleAmount/t.getRevenue*100)):"涮嘴零食"===e._id?(t.categorySalesChart[1].category.series=[Math.round(e.totalSaleAmount/t.targetSales[1]*100)],t.categorySalesChart[1].category.totalSaleAmount=e.totalSaleAmount,t.pie[0].all.series[1]=Math.round(e.totalSaleAmount/t.getRevenue*100)):"寵物用品"===e._id?(t.categorySalesChart[2].category.series=[Math.round(e.totalSaleAmount/t.targetSales[2]*100)],t.categorySalesChart[2].category.totalSaleAmount=e.totalSaleAmount,t.pie[0].all.series[2]=Math.round(e.totalSaleAmount/t.getRevenue*100)):"美妝保健"===e._id?(t.categorySalesChart[3].makeup.series=[Math.round(e.totalSaleAmount/t.targetSales[3]*100)],t.categorySalesChart[3].category.totalSaleAmount=e.totalSaleAmount,t.pie[0].all.series[3]=Math.round(e.totalSaleAmount/t.getRevenue*100)):"3C用品"===e._id&&(t.categorySalesChart[4].category.series=[Math.round(e.totalSaleAmount/t.targetSales[4]*100)],t.categorySalesChart[4].category.totalSaleAmount=e.totalSaleAmount,t.pie[0].all.series[4]=Math.round(e.totalSaleAmount/t.getRevenue*100)),e})),e.prev=2,e.next=5,t.axios.get("/orders/getOrdersQuantity",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 5:r=e.sent,o=r.data,t.orders=o.result.filter((function(e){return e.year===t.year&&e.month===t.month})),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),t.$swal({icon:"error",title:"錯誤",text:"取得訂單數量失敗"});case 13:return e.prev=13,e.next=16,t.axios.get("/admins",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 16:s=e.sent,n=s.data,t.targetSales=n.result.targetSales,e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](13),t.$swal({icon:"error",title:"錯誤",text:"取得資料失敗"});case 24:case"end":return e.stop()}}),e,null,[[2,10],[13,21]])})))()},update:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/orders/getCategorySales",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 2:a=e.sent,r=a.data,r.result=r.result.map((function(t){return t=Object(s["a"])(Object(s["a"])({},t._id),{},{totalSaleAmount:t.totalSaleAmount}),t})),t.categorySales=r.result.filter((function(e){return e.year===t.year&&e.month===t.month})),t.count();case 7:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r,o,n,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.get("/orders/getCategorySales",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 3:a=e.sent,r=a.data,r.result=r.result.map((function(t){return t=Object(s["a"])(Object(s["a"])({},t._id),{},{totalSaleAmount:t.totalSaleAmount}),t})),t.categorySales=r.result.filter((function(e){return e.year===t.year&&e.month===t.month})),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得分類業績失敗"});case 12:return e.prev=12,e.next=15,t.axios.get("/admins",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 15:o=e.sent,n=o.data,t.targetSales=n.result.targetSales,t.count(),e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](12),t.$swal({icon:"error",title:"錯誤",text:"取得資料失敗"});case 24:return e.prev=24,e.next=27,t.axios.get("/orders/getProductSales",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 27:i=e.sent,l=i.data,t.products=l.result.map((function(t){return t=Object(s["a"])(Object(s["a"])({},t._id),{},{productQuantity:t.productQuantity,productSaleAmount:t.productSaleAmount}),null===t.image||0===t.image.length?(t.image=t.imagefiles.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]):(t.image=t.image.concat(t.imagefiles),t.image=t.image.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]),t})),e.next=35;break;case 32:e.prev=32,e.t2=e["catch"](24),t.$swal({icon:"error",title:"錯誤",text:"取得商品業績失敗"});case 35:case"end":return e.stop()}}),e,null,[[0,9],[12,21],[24,32]])})))()},watch:{year:{handler:function(){this.update(),this.count()},deep:!0},month:{handler:function(){this.update(),this.count()},deep:!0}}}),l=i,c=a("2877"),u=a("6544"),d=a.n(u),p=a("8336"),h=a("99d9"),m=a("62ad"),f=a("8fea"),g=a("169a"),v=a("132d"),b=a("0fd9"),x=a("b974"),w=a("2fa4"),y=a("8654"),k=Object(c["a"])(l,r,o,!1,null,null,null);e["default"]=k.exports;d()(k,{VBtn:p["a"],VCardActions:h["a"],VCardText:h["b"],VCol:m["a"],VDataTable:f["a"],VDialog:g["a"],VIcon:v["a"],VRow:b["a"],VSelect:x["a"],VSpacer:w["a"],VTextField:y["a"]})},d257:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"adminorders"}},[a("v-data-table",{attrs:{headers:t.headers,items:t.orders,expanded:t.expanded,"item-key":"_id","show-expand":""},on:{"click:row":t.clicked},scopedSlots:t._u([{key:"expanded-item",fn:function(e){var r=e.item;return[a("td",{staticClass:"py-4",attrs:{colspan:t.headers.length+1}},[a("OrderCard",{attrs:{item:r}})],1)]}},{key:"item.actions",fn:function(e){var r=e.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(e){return t.editItem(r)}}},[t._v("mdi-pencil-circle-outline")])]}}])}),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",{staticClass:"pa-5",attrs:{color:"#ebedee"}},[a("v-card-title",[a("span",{staticClass:"text-h5 font-weight-bold"},[t._v("編輯訂單")])]),a("v-card-text",[a("v-row",[a("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[a("span",[t._v("宅配單號")])]),a("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[a("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",required:""},model:{value:t.form.delivery_number,callback:function(e){t.$set(t.form,"delivery_number",e)},expression:"form.delivery_number"}})],1)],1),a("v-row",[a("v-col",{staticClass:"pb-0 pt-0",attrs:{cols:"12"}},[a("span",[t._v("訂購人姓名")])]),a("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[a("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),a("v-row",[a("v-col",{staticClass:"pb-0 pt-0",attrs:{cols:"12"}},[a("span",[t._v("地址")])]),a("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[a("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",required:""},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1),a("v-row",[a("v-col",{staticClass:"pb-0 pt-0",attrs:{cols:"12"}},[a("span",[t._v("電話號碼")])]),a("v-col",{staticClass:"pt-1 pb-0",attrs:{cols:"12"}},[a("v-text-field",{attrs:{"background-color":"white",solo:"",dense:"",required:""},model:{value:t.form.contact_number,callback:function(e){t.$set(t.form,"contact_number",e)},expression:"form.contact_number"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"mr-2 mb-1",attrs:{plain:""},on:{click:t.editCancel}},[t._v("取消")]),a("v-btn",{staticClass:"mr-2 mb-1 px-8",attrs:{color:"#f7e7ef"},on:{click:t.editSave}},[t._v("儲存")])],1)],1)],1)],1)},o=[],s=a("5530"),n=a("1da1"),i=(a("96cf"),a("b0c0"),a("d81d"),a("fb6a"),a("99af"),a("8a35"),a("5e86")),l={name:"Adminorders",data:function(){return{form:{address:"",contact_number:"",delivery_number:"",name:"",_id:"",state:""},editedIndex:-1,expanded:["orders"],singleExpand:!1,search:"",dialog:!1,orders:[],headers:[{text:"訂單編號",align:"center",value:"_id",sortable:!1},{text:"訂購人",value:"name"},{text:"地址",value:"address"},{text:"聯絡方式",value:"contact_number"},{text:"訂單日期",value:"date"},{text:"總金額",value:"sum"},{text:"折價",value:"redeem"},{text:"付款狀態",value:"payment"},{text:"宅配單號",value:"delivery_number"},{text:"訂單狀態",value:"state"},{text:"編輯",value:"actions"}]}},components:{OrderCard:i["a"]},methods:{clicked:function(t){this.expanded.push(t)},editItem:function(t){this.dialog=!0,this.editedIndex=this.orders.indexOf(t),this.form={address:this.orders[this.editedIndex].address,contact_number:this.orders[this.editedIndex].contact_number,delivery_number:this.orders[this.editedIndex].delivery_number,name:this.orders[this.editedIndex].name,_id:this.orders[this.editedIndex]._id}},editCancel:function(){this.dialog=!1},editSave:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dialog=!1,e.prev=1,t.form.delivery_number&&(t.form.state="已出貨"),e.next=5,t.axios.patch("/orders/"+t.form._id,t.form,{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 5:return e.next=7,t.axios.get("/orders/getAllorders",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 7:a=e.sent,r=a.data,t.orders=r.result.map((function(t){return t.date=t.date.slice(0,10),!1===t.payment?t.payment="待付款":t.payment="已付款",t.products=t.products.map((function(t){return t=Object(s["a"])(Object(s["a"])({},t.product),{},{amount:t.amount,option:t.option}),null===t.image||0===t.image.length?(t.image=t.imagefiles.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]):(t.image=t.image.concat(t.imagefiles),t.image=t.image.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]),t})),t})),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),t.$swal({icon:"error",title:"失敗",text:"修改失敗"});case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))()}},mounted:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.get("/orders/getAllorders",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 3:a=e.sent,r=a.data,t.orders=r.result.map((function(t){return t.date=t.date.slice(0,10),!1===t.payment?t.payment="待付款":t.payment="已付款",t.products=t.products.map((function(t){return t=Object(s["a"])(Object(s["a"])({},t.product),{},{amount:t.amount,option:t.option}),null===t.image||0===t.image.length?(t.image=t.imagefiles.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]):(t.image=t.image.concat(t.imagefiles),t.image=t.image.map((function(t){return"".concat("https://kt17977777777777.herokuapp.com","/files/").concat(t)})),t.imagefiles=[]),t})),t})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得訂單失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}},c=l,u=a("2877"),d=a("6544"),p=a.n(d),h=a("8336"),m=a("b0af"),f=a("99d9"),g=a("62ad"),v=a("8fea"),b=a("169a"),x=a("132d"),w=a("0fd9"),y=a("2fa4"),k=a("8654"),C=Object(u["a"])(c,r,o,!1,null,null,null);e["default"]=C.exports;p()(C,{VBtn:h["a"],VCard:m["a"],VCardActions:f["a"],VCardText:f["b"],VCardTitle:f["c"],VCol:g["a"],VDataTable:v["a"],VDialog:b["a"],VIcon:x["a"],VRow:w["a"],VSpacer:y["a"],VTextField:k["a"]})},ec29:function(t,e,a){}}]);
//# sourceMappingURL=admin.2c0425ab.js.map